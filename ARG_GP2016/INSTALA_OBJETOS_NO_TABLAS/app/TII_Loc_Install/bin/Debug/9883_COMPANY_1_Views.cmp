/*Count : 27 */
 
set DATEFORMAT ymd 
GO 
 
/*Begin_AWLI_DOCUMENTOS*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[AWLI_DOCUMENTOS]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[AWLI_DOCUMENTOS]
GO

CREATE VIEW dbo.AWLI_DOCUMENTOS 
AS 
SELECT     2 AS TYPE, 'WORK' AS STATE, RM10301.RMDTYPAL AS DOCTYPE, RM10301.DOCNUMBR AS DOCNUMBR, RM10301.DOCNUMBR AS VCHRNMBR,    
                      RM10301.DOCDATE AS DOCDATE, RM10301.GLPOSTDT AS GLPOSTDT, RM10301.CUSTNMBR AS CUSTVENDID, RM00101.CUSTNAME AS CUSTVENDNAME,    
                      RM00101.TXRGNNUM AS TXRGNNUM, RM10301.SLSAMNT AS SALESPURCHAMNT, RM10301.TRDISAMT AS TRDISAMT,    
                      RM10301.FRTAMNT AS FRTAMNT, RM10301.MISCAMNT AS MISCAMNT, RM10301.TAXAMNT AS TAXAMNT, RM10301.DOCAMNT AS DOCAMNT,    
                      0 AS Voided, '' AS DOCID,    
                      CASE RM10301.RMDTYPAL WHEN 1 THEN 'FACTURA' WHEN 3 THEN 'N.DEBIT' WHEN 4 THEN 'CS.FIN.' WHEN 5 THEN 'SRV.REP' WHEN 6 THEN 'GARANTI'   
                       WHEN 7 THEN 'N.CREDI' WHEN 8 THEN 'DEVOLUC' END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, RM10301.CURNCYID   
FROM         RM10301 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON RM10301.CUSTNMBR = RM00101.CUSTNMBR   
WHERE     (RM10301.RMDTYPAL = 1 OR   
                      RM10301.RMDTYPAL = 3 OR   
                      RM10301.RMDTYPAL = 4 OR   
                      RM10301.RMDTYPAL = 5 OR   
                      RM10301.RMDTYPAL = 6 OR   
                      RM10301.RMDTYPAL = 7 OR   
                      RM10301.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, 'OPEN' AS STATE, RM20101.RMDTYPAL AS DOCTYPE, RM20101.DOCNUMBR AS DOCNUMBR, RM20101.DOCNUMBR AS VCHRNMBR,    
                      RM20101.DOCDATE AS DOCDATE, RM20101.GLPOSTDT AS GLPOSTDT, RM20101.CUSTNMBR AS CUSTVENDID,    
                      CASE RM20101.VOIDSTTS WHEN 0 THEN (CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.CUSTNAME ELSE SOP30200.CUSTNAME END) WHEN 1 THEN 'ANULADO' END AS CUSTVENDNAME,    
                      CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.TXRGNNUM ELSE SOP30200.TXRGNNUM END AS TXRGNNUM, CASE RM20101.VOIDSTTS WHEN 0 THEN RM20101.SLSAMNT WHEN 1 THEN 0 END AS SALESPURCHAMNT,    
                      CASE RM20101.VOIDSTTS WHEN 0 THEN RM20101.TRDISAMT WHEN 1 THEN 0 END AS TRDISAMT, RM20101.FRTAMNT AS FRTAMNT,    
                      CASE RM20101.VOIDSTTS WHEN 0 THEN RM20101.MISCAMNT WHEN 1 THEN 0 END AS MISCAMNT,    
                      CASE RM20101.VOIDSTTS WHEN 0 THEN RM20101.TAXAMNT WHEN 1 THEN 0 END AS TAXAMNT,    
                      CASE RM20101.VOIDSTTS WHEN 0 THEN RM20101.ORTRXAMT WHEN 1 THEN 0 END AS DOCAMNT, RM20101.VOIDSTTS AS Voided,    
                      ISNULL(SOP30200.DOCID, '') AS DOCID,    
                      CASE RM20101.RMDTYPAL WHEN 1 THEN 'FACTURA' WHEN 3 THEN 'N.DEBIT' WHEN 4 THEN 'CS.FIN.' WHEN 5 THEN 'SRV.REP' WHEN 6 THEN 'GARANTI'   
                       WHEN 7 THEN 'N.CREDI' WHEN 8 THEN 'DEVOLUC' END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, RM20101.CURNCYID   
FROM         RM20101 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON RM20101.CUSTNMBR = RM00101.CUSTNMBR LEFT OUTER JOIN   
                      SOP30200 WITH (NOLOCK) ON RM20101.DOCNUMBR = SOP30200.SOPNUMBE AND RM20101.CUSTNMBR = SOP30200.CUSTNMBR AND    
                      (RM20101.RMDTYPAL = 1 AND SOP30200.SOPTYPE = 3 OR   
                      RM20101.RMDTYPAL = 8 AND SOP30200.SOPTYPE = 4)   
WHERE     (RM20101.RMDTYPAL = 1 OR   
                      RM20101.RMDTYPAL = 3 OR   
                      RM20101.RMDTYPAL = 4 OR   
                      RM20101.RMDTYPAL = 5 OR   
                      RM20101.RMDTYPAL = 6 OR   
                      RM20101.RMDTYPAL = 7 OR   
                      RM20101.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, 'HIST' AS STATE, RM30101.RMDTYPAL AS DOCTYPE, RM30101.DOCNUMBR AS DOCNUMBR, RM30101.DOCNUMBR AS VCHRNMBR,    
                      RM30101.DOCDATE AS DOCDATE, RM30101.GLPOSTDT AS GLPOSTDT, RM30101.CUSTNMBR AS CUSTVENDID,    
                      CASE RM30101.VOIDSTTS WHEN 0 THEN (CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.CUSTNAME ELSE SOP30200.CUSTNAME END) WHEN 1 THEN 'ANULADO' END AS CUSTVENDNAME,    
                      CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.TXRGNNUM ELSE SOP30200.TXRGNNUM END AS TXRGNNUM, CASE RM30101.VOIDSTTS WHEN 0 THEN RM30101.SLSAMNT WHEN 1 THEN 0 END AS SALESPURCHAMNT,    
                      CASE RM30101.VOIDSTTS WHEN 0 THEN RM30101.TRDISAMT WHEN 1 THEN 0 END AS TRDISAMT, RM30101.FRTAMNT AS FRTAMNT,    
                      CASE RM30101.VOIDSTTS WHEN 0 THEN RM30101.MISCAMNT WHEN 1 THEN 0 END AS MISCAMNT,    
                      CASE RM30101.VOIDSTTS WHEN 0 THEN RM30101.TAXAMNT WHEN 1 THEN 0 END AS TAXAMNT,    
                      CASE RM30101.VOIDSTTS WHEN 0 THEN RM30101.ORTRXAMT WHEN 1 THEN 0 END AS DOCAMNT, RM30101.VOIDSTTS AS Voided,    
                      ISNULL(SOP30200.DOCID, '') AS DOCID,    
                      CASE RM30101.RMDTYPAL WHEN 1 THEN 'FACTURA' WHEN 3 THEN 'N.DEBIT' WHEN 4 THEN 'CS.FIN.' WHEN 5 THEN 'SRV.REP' WHEN 6 THEN 'GARANTI'   
                       WHEN 7 THEN 'N.CREDI' WHEN 8 THEN 'DEVOLUC' END AS DOCTYPEDESC, RM30101.VOIDDATE, RM30101.CURNCYID   
FROM         RM30101 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON RM30101.CUSTNMBR = RM00101.CUSTNMBR LEFT OUTER JOIN   
                      SOP30200 WITH (NOLOCK) ON RM30101.DOCNUMBR = SOP30200.SOPNUMBE AND RM30101.CUSTNMBR = SOP30200.CUSTNMBR AND    
                      (RM30101.RMDTYPAL = 1 AND SOP30200.SOPTYPE = 3 OR   
                      RM30101.RMDTYPAL = 8 AND SOP30200.SOPTYPE = 4)   
WHERE     (RM30101.RMDTYPAL = 1 OR   
                      RM30101.RMDTYPAL = 3 OR   
                      RM30101.RMDTYPAL = 4 OR   
                      RM30101.RMDTYPAL = 5 OR   
                      RM30101.RMDTYPAL = 6 OR   
                      RM30101.RMDTYPAL = 7 OR   
                      RM30101.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, 'WORK' AS STATE, (CASE SOP10100.SOPTYPE WHEN 3 THEN 1 WHEN 4 THEN 8 END) AS DOCTYPE,    
                      SOP10100.SOPNUMBE AS DOCNUMBR, SOP10100.SOPNUMBE AS VCHRNMBR, SOP10100.DOCDATE AS DOCDATE,  SOP10100.GLPOSTDT AS GLPOSTDT,  
                      SOP10100.CUSTNMBR AS CUSTVENDID, RM00101.CUSTNAME AS CUSTVENDNAME, RM00101.TXRGNNUM AS TXRGNNUM,    
                      SOP10100.SUBTOTAL AS SALESPURCHAMNT, SOP10100.TRDISAMT AS TRDISAMT, SOP10100.FRTAMNT AS FRTAMNT,    
                      SOP10100.MISCAMNT AS MISCAMNT, SOP10100.TAXAMNT AS TAXAMNT, SOP10100.DOCAMNT AS DOCAMNT, SOP10100.VOIDSTTS AS Voided,    
                      SOP10100.DOCID AS DOCID, CASE SOP10100.SOPTYPE WHEN 3 THEN 'FACTURA' WHEN 4 THEN 'DEVOLUC' END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, SOP10100.CURNCYID   
FROM         SOP10100 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON SOP10100.CUSTNMBR = RM00101.CUSTNMBR   
WHERE     (SOP10100.SOPTYPE = 3 OR   
                      SOP10100.SOPTYPE = 4)   
UNION   
SELECT     2 AS TYPE, 'HIST' AS STATE, (CASE SOP30200.SOPTYPE WHEN 3 THEN 1 WHEN 4 THEN 8 END) AS DOCTYPE,    
                      SOP30200.SOPNUMBE AS DOCNUMBR, SOP30200.SOPNUMBE AS VCHRNMBR, SOP30200.DOCDATE AS DOCDATE,  SOP30200.GLPOSTDT AS GLPOSTDT,  
                      SOP30200.CUSTNMBR AS CUSTVENDID, 'ANULADO' AS CUSTVENDNAME, TXRGNNUM, 0 AS SALESPURCHAMNT,    
                      0 AS TRDISAMT, 0 AS FRTAMNT, 0 AS MISCAMNT, 0 AS TAXAMNT, 0 AS DOCAMNT, SOP30200.VOIDSTTS AS Voided, SOP30200.DOCID AS DOCID,    
                      CASE SOP30200.SOPTYPE WHEN 3 THEN 'FACTURA' WHEN 4 THEN 'DEVOLUC' END AS DOCTYPEDESC, SOP30200.MODIFDT AS VOIDDATE, SOP30200.CURNCYID   
FROM         SOP30200 
WHERE     (SOP30200.SOPTYPE = 3 OR   
                      SOP30200.SOPTYPE = 4) AND SOP30200.VOIDSTTS = 1   
  
UNION   
SELECT     1 AS TYPE, 'WORK' AS STATE, PM10000.DOCTYPE AS DOCTYPE, PM10000.DOCNUMBR AS DOCNUMBR, PM10000.VCHRNMBR AS VCHRNMBR,    
                      PM10000.DOCDATE AS DOCDATE, PM10000.PSTGDATE AS GLPOSTDT,PM10000.VENDORID AS CUSTVENDID,    
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN PM10000.TRXDSCRN ELSE PM00200.VENDNAME END AS CUSTVENDNAME,        
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN LEFT(PM10000.PORDNMBR, 18) + '     ' + SUBSTRING(PM10000.PORDNMBR,19, 2) ELSE PM00200.TXRGNNUM END AS TXRGNNUM,    
                      PM10000.PRCHAMNT AS SALESPURCHAMNT, PM10000.TRDISAMT AS TRDISAMT,    
                      PM10000.FRTAMNT AS FRTAMNT, PM10000.MSCCHAMT AS MISCAMNT, PM10000.TAXAMNT AS TAXAMNT, PM10000.DOCAMNT AS DOCAMNT,    
                      0 AS Voided, '' AS DOCID,    
                      CASE PM10000.DOCTYPE WHEN 1 THEN 'FACTURA' WHEN 2 THEN 'CS.FIN.' WHEN 3 THEN 'CS.MISC' WHEN 4 THEN 'DEVOLUC' WHEN 5 THEN 'N.CREDI'   
                       END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, PM10000.CURNCYID  
FROM         PM10000 WITH (NOLOCK) LEFT JOIN   
                      PM00200 WITH (NOLOCK) ON PM10000.VENDORID = PM00200.VENDORID LEFT JOIN TII_CHQ_SY40000 WITH (NOLOCK) ON PM00200.VNDCLSID = TII_CHQ_SY40000.VNDCLSID  
WHERE     (PM10000.DOCTYPE = 1 OR   
                      PM10000.DOCTYPE = 2 OR   
                      PM10000.DOCTYPE = 3 OR   
                      PM10000.DOCTYPE = 4 OR   
                      PM10000.DOCTYPE = 5)   
UNION   
SELECT     1 AS TYPE, 'OPEN' AS STATE, PM20000.DOCTYPE AS DOCTYPE, PM20000.DOCNUMBR AS DOCNUMBR, PM20000.VCHRNMBR AS VCHRNMBR,    
                      PM20000.DOCDATE AS DOCDATE,PM20000.PSTGDATE AS GLPOSTDT, PM20000.VENDORID AS CUSTVENDID,    
                      CASE PM20000.VOIDED WHEN 0 THEN CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN PM20000.TRXDSCRN ELSE PM00200.VENDNAME END WHEN 1 THEN 'ANULADO' END AS CUSTVENDNAME,    
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN LEFT(PM20000.PORDNMBR, 18) + '     ' + SUBSTRING(PM20000.PORDNMBR,19, 2) ELSE PM00200.TXRGNNUM END AS TXRGNNUM,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.PRCHAMNT WHEN 1 THEN 0 END AS SALESPURCHAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.TRDISAMT WHEN 1 THEN 0 END AS TRDISAMT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.FRTAMNT WHEN 1 THEN 0 END AS FRTAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.MSCCHAMT WHEN 1 THEN 0 END AS MISCAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.TAXAMNT WHEN 1 THEN 0 END AS TAXAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.DOCAMNT WHEN 1 THEN 0 END AS DOCAMNT, PM20000.VOIDED AS Voided, '' AS DOCID,    
                      CASE PM20000.DOCTYPE WHEN 1 THEN 'FACTURA' WHEN 2 THEN 'CS.FIN.' WHEN 3 THEN 'CS.MISC' WHEN 4 THEN 'DEVOLUC' WHEN 5 THEN 'N.CREDI'   
                       END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, PM20000.CURNCYID   
FROM         PM20000 WITH (NOLOCK) LEFT JOIN   
                      PM00200 WITH (NOLOCK) ON PM20000.VENDORID = PM00200.VENDORID LEFT JOIN TII_CHQ_SY40000 WITH (NOLOCK) ON PM00200.VNDCLSID = TII_CHQ_SY40000.VNDCLSID   
WHERE     (PM20000.DOCTYPE = 1 OR   
                      PM20000.DOCTYPE = 2 OR   
                      PM20000.DOCTYPE = 3 OR   
                      PM20000.DOCTYPE = 4 OR   
                      PM20000.DOCTYPE = 5) AND PM20000.VOIDED = 0  
UNION   
SELECT     1 AS TYPE, 'HIST' AS STATE, PM30200.DOCTYPE AS DOCTYPE, PM30200.DOCNUMBR AS DOCNUMBR, PM30200.VCHRNMBR AS VCHRNMBR,    
                      PM30200.DOCDATE AS DOCDATE, PM30200.PSTGDATE AS GLPOSTDT,PM30200.VENDORID AS CUSTVENDID,    
                      CASE PM30200.VOIDED WHEN 0 THEN CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN PM30200.TRXDSCRN ELSE PM00200.VENDNAME END WHEN 1 THEN 'ANULADO' END AS CUSTVENDNAME,    
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN LEFT(PM30200.PORDNMBR, 18) + '     ' + SUBSTRING(PM30200.PORDNMBR,19, 2) ELSE PM00200.TXRGNNUM END AS TXRGNNUM,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.PRCHAMNT WHEN 1 THEN 0 END AS SALESPURCHAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.TRDISAMT WHEN 1 THEN 0 END AS TRDISAMT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.FRTAMNT WHEN 1 THEN 0 END AS FRTAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.MSCCHAMT WHEN 1 THEN 0 END AS MISCAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.TAXAMNT WHEN 1 THEN 0 END AS TAXAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.DOCAMNT WHEN 1 THEN 0 END AS DOCAMNT, PM30200.VOIDED AS Voided, '' AS DOCID,    
                      CASE PM30200.DOCTYPE WHEN 1 THEN 'FACTURA' WHEN 2 THEN 'CS.FIN.' WHEN 3 THEN 'CS.MISC' WHEN 4 THEN 'DEVOLUC' WHEN 5 THEN 'N.CREDI'   
                       END AS DOCTYPEDESC, PM30200.VOIDPDATE AS VOIDDATE, PM30200.CURNCYID   
FROM         PM30200 WITH (NOLOCK) LEFT JOIN   
                      PM00200 WITH (NOLOCK) ON PM30200.VENDORID = PM00200.VENDORID LEFT JOIN TII_CHQ_SY40000 WITH (NOLOCK) ON PM00200.VNDCLSID = TII_CHQ_SY40000.VNDCLSID   
WHERE     (PM30200.DOCTYPE = 1 OR   
                      PM30200.DOCTYPE = 2 OR   
                      PM30200.DOCTYPE = 3 OR   
                      PM30200.DOCTYPE = 4 OR   
                      PM30200.DOCTYPE = 5) AND PM30200.VOIDED = 0  
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[AWLI_DOCUMENTOS]  TO [DYNGRP] 
GO
/*End_AWLI_DOCUMENTOS*/
/*Begin_AWLI_DOCUMENTOS_SM*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[AWLI_DOCUMENTOS_SM]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[AWLI_DOCUMENTOS_SM]
GO

CREATE VIEW dbo.AWLI_DOCUMENTOS_SM 
AS 
SELECT     2 AS TYPE, 'WORK' AS STATE, RM10301.RMDTYPAL AS DOCTYPE, RM10301.DOCNUMBR AS DOCNUMBR, RM10301.DOCNUMBR AS VCHRNMBR,    
                      RM10301.DOCDATE AS DOCDATE, RM10301.GLPOSTDT AS GLPOSTDT, RM10301.CUSTNMBR AS CUSTVENDID, RM00101.CUSTNAME AS CUSTVENDNAME,    
                      RM00101.TXRGNNUM AS TXRGNNUM, RM10301.SLSAMNT AS SALESPURCHAMNT, RM10301.TRDISAMT AS TRDISAMT,    
                      RM10301.FRTAMNT AS FRTAMNT, RM10301.MISCAMNT AS MISCAMNT, RM10301.TAXAMNT AS TAXAMNT, RM10301.DOCAMNT AS DOCAMNT,    
                      0 AS Voided, '' AS DOCID,    
                      CASE RM10301.RMDTYPAL WHEN 1 THEN 'FACTURA' WHEN 3 THEN 'N.DEBIT' WHEN 4 THEN 'CS.FIN.' WHEN 5 THEN 'SRV.REP' WHEN 6 THEN 'GARANTI'   
                       WHEN 7 THEN 'N.CREDI' WHEN 8 THEN 'DEVOLUC' END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, RM10301.CURNCYID   
FROM         RM10301 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON RM10301.CUSTNMBR = RM00101.CUSTNMBR   
WHERE     (RM10301.RMDTYPAL = 1 OR   
                      RM10301.RMDTYPAL = 3 OR   
                      RM10301.RMDTYPAL = 4 OR   
                      RM10301.RMDTYPAL = 5 OR   
                      RM10301.RMDTYPAL = 6 OR   
                      RM10301.RMDTYPAL = 7 OR   
                      RM10301.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, 'OPEN' AS STATE, RM20101.RMDTYPAL AS DOCTYPE, RM20101.DOCNUMBR AS DOCNUMBR, RM20101.DOCNUMBR AS VCHRNMBR,    
                      RM20101.DOCDATE AS DOCDATE, RM20101.GLPOSTDT AS GLPOSTDT, RM20101.CUSTNMBR AS CUSTVENDID,    
                      CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.CUSTNAME ELSE SOP30200.CUSTNAME END AS CUSTVENDNAME,    
                      CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.TXRGNNUM ELSE SOP30200.TXRGNNUM END AS TXRGNNUM, 
                      RM20101.SLSAMNT AS SALESPURCHAMNT,    
                      RM20101.TRDISAMT AS TRDISAMT, RM20101.FRTAMNT AS FRTAMNT,    
                      RM20101.MISCAMNT AS MISCAMNT,    
                      RM20101.TAXAMNT AS TAXAMNT,    
                      RM20101.ORTRXAMT AS DOCAMNT, RM20101.VOIDSTTS AS Voided,    
                      ISNULL(SOP30200.DOCID, '') AS DOCID,    
                      CASE RM20101.RMDTYPAL WHEN 1 THEN 'FACTURA' WHEN 3 THEN 'N.DEBIT' WHEN 4 THEN 'CS.FIN.' WHEN 5 THEN 'SRV.REP' WHEN 6 THEN 'GARANTI'   
                       WHEN 7 THEN 'N.CREDI' WHEN 8 THEN 'DEVOLUC' END AS DOCTYPEDESC, RM20101.VOIDDATE AS VOIDDATE, RM20101.CURNCYID   
FROM         RM20101 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON RM20101.CUSTNMBR = RM00101.CUSTNMBR LEFT OUTER JOIN   
                      SOP30200 WITH (NOLOCK) ON RM20101.DOCNUMBR = SOP30200.SOPNUMBE AND RM20101.CUSTNMBR = SOP30200.CUSTNMBR AND    
                      (RM20101.RMDTYPAL = 1 AND SOP30200.SOPTYPE = 3 OR   
                      RM20101.RMDTYPAL = 8 AND SOP30200.SOPTYPE = 4)   
WHERE     (RM20101.RMDTYPAL = 1 OR   
                      RM20101.RMDTYPAL = 3 OR   
                      RM20101.RMDTYPAL = 4 OR   
                      RM20101.RMDTYPAL = 5 OR   
                      RM20101.RMDTYPAL = 6 OR   
                      RM20101.RMDTYPAL = 7 OR   
                      RM20101.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, 'HIST' AS STATE, RM30101.RMDTYPAL AS DOCTYPE, RM30101.DOCNUMBR AS DOCNUMBR, RM30101.DOCNUMBR AS VCHRNMBR,    
                      RM30101.DOCDATE AS DOCDATE, RM30101.GLPOSTDT AS GLPOSTDT, RM30101.CUSTNMBR AS CUSTVENDID,    
                      CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.CUSTNAME ELSE SOP30200.CUSTNAME END AS CUSTVENDNAME,     
                      CASE ISNULL(SOP30200.DOCID, '') WHEN '' THEN RM00101.TXRGNNUM ELSE SOP30200.TXRGNNUM END AS TXRGNNUM,     
                      RM30101.SLSAMNT AS SALESPURCHAMNT,    
                      RM30101.TRDISAMT AS TRDISAMT, RM30101.FRTAMNT AS FRTAMNT,    
                      RM30101.MISCAMNT AS MISCAMNT,    
                      RM30101.TAXAMNT AS TAXAMNT,    
                      RM30101.ORTRXAMT AS DOCAMNT, RM30101.VOIDSTTS AS Voided,    
                      ISNULL(SOP30200.DOCID, '') AS DOCID,    
                      CASE RM30101.RMDTYPAL WHEN 1 THEN 'FACTURA' WHEN 3 THEN 'N.DEBIT' WHEN 4 THEN 'CS.FIN.' WHEN 5 THEN 'SRV.REP' WHEN 6 THEN 'GARANTI'   
                       WHEN 7 THEN 'N.CREDI' WHEN 8 THEN 'DEVOLUC' END AS DOCTYPEDESC, RM30101.VOIDDATE, RM30101.CURNCYID   
FROM         RM30101 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON RM30101.CUSTNMBR = RM00101.CUSTNMBR LEFT OUTER JOIN   
                      SOP30200 WITH (NOLOCK) ON RM30101.DOCNUMBR = SOP30200.SOPNUMBE AND RM30101.CUSTNMBR = SOP30200.CUSTNMBR AND    
                      (RM30101.RMDTYPAL = 1 AND SOP30200.SOPTYPE = 3 OR   
                      RM30101.RMDTYPAL = 8 AND SOP30200.SOPTYPE = 4)   
WHERE     (RM30101.RMDTYPAL = 1 OR   
                      RM30101.RMDTYPAL = 3 OR   
                      RM30101.RMDTYPAL = 4 OR   
                      RM30101.RMDTYPAL = 5 OR   
                      RM30101.RMDTYPAL = 6 OR   
                      RM30101.RMDTYPAL = 7 OR   
                      RM30101.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, 'WORK' AS STATE, (CASE SOP10100.SOPTYPE WHEN 3 THEN 1 WHEN 4 THEN 8 END) AS DOCTYPE,    
                      SOP10100.SOPNUMBE AS DOCNUMBR, SOP10100.SOPNUMBE AS VCHRNMBR, SOP10100.DOCDATE AS DOCDATE,  SOP10100.GLPOSTDT AS GLPOSTDT,  
                      SOP10100.CUSTNMBR AS CUSTVENDID, SOP10100.CUSTNAME AS CUSTVENDNAME, SOP10100.TXRGNNUM AS TXRGNNUM,    
                      SOP10100.SUBTOTAL AS SALESPURCHAMNT, SOP10100.TRDISAMT AS TRDISAMT, SOP10100.FRTAMNT AS FRTAMNT,    
                      SOP10100.MISCAMNT AS MISCAMNT, SOP10100.TAXAMNT AS TAXAMNT, SOP10100.DOCAMNT AS DOCAMNT, SOP10100.VOIDSTTS AS Voided,    
                      SOP10100.DOCID AS DOCID, CASE SOP10100.SOPTYPE WHEN 3 THEN 'FACTURA' WHEN 4 THEN 'DEVOLUC' END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, SOP10100.CURNCYID   
FROM         SOP10100 WITH (NOLOCK) LEFT JOIN   
                      RM00101 WITH (NOLOCK) ON SOP10100.CUSTNMBR = RM00101.CUSTNMBR   
WHERE     (SOP10100.SOPTYPE = 3 OR   
                      SOP10100.SOPTYPE = 4)   
UNION   
SELECT     2 AS TYPE, 'HIST' AS STATE, (CASE SOP30200.SOPTYPE WHEN 3 THEN 1 WHEN 4 THEN 8 END) AS DOCTYPE,    
                      SOP30200.SOPNUMBE AS DOCNUMBR, SOP30200.SOPNUMBE AS VCHRNMBR, SOP30200.DOCDATE AS DOCDATE,  SOP30200.GLPOSTDT AS GLPOSTDT,  
                      SOP30200.CUSTNMBR AS CUSTVENDID, SOP30200.CUSTNAME AS CUSTVENDNAME, SOP30200.TXRGNNUM AS TXRGNNUM,  
                      SOP30200.SUBTOTAL AS SALESPURCHAMNT, SOP30200.TRDISAMT AS TRDISAMT, SOP30200.FRTAMNT AS FRTAMNT,    
                      SOP30200.MISCAMNT AS MISCAMNT, SOP30200.TAXAMNT AS TAXAMNT, SOP30200.DOCAMNT AS DOCAMNT, SOP30200.VOIDSTTS AS Voided,    
                      SOP30200.DOCID AS DOCID,    
                      CASE SOP30200.SOPTYPE WHEN 3 THEN 'FACTURA' WHEN 4 THEN 'DEVOLUC' END AS DOCTYPEDESC, SOP30200.MODIFDT AS VOIDDATE, SOP30200.CURNCYID   
FROM         SOP30200 WITH (NOLOCK) 
WHERE     (SOP30200.SOPTYPE = 3 OR   
                      SOP30200.SOPTYPE = 4) AND SOP30200.VOIDSTTS = 1   
  
UNION   
SELECT     1 AS TYPE, 'WORK' AS STATE, PM10000.DOCTYPE AS DOCTYPE, PM10000.DOCNUMBR AS DOCNUMBR, PM10000.VCHRNMBR AS VCHRNMBR,    
                      PM10000.DOCDATE AS DOCDATE, PM10000.PSTGDATE AS GLPOSTDT,PM10000.VENDORID AS CUSTVENDID,    
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN PM00200.VENDNAME ELSE PM10000.TRXDSCRN END AS CUSTVENDNAME,
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN LEFT(PM10000.PORDNMBR, 18) + '     ' + SUBSTRING(PM10000.PORDNMBR,19, 2) ELSE PM00200.TXRGNNUM END AS TXRGNNUM,    
                      PM10000.PRCHAMNT AS SALESPURCHAMNT, PM10000.TRDISAMT AS TRDISAMT,    
                      PM10000.FRTAMNT AS FRTAMNT, PM10000.MSCCHAMT AS MISCAMNT, PM10000.TAXAMNT AS TAXAMNT, PM10000.DOCAMNT AS DOCAMNT,    
                      0 AS Voided, '' AS DOCID,    
                      CASE PM10000.DOCTYPE WHEN 1 THEN 'FACTURA' WHEN 2 THEN 'CS.FIN.' WHEN 3 THEN 'CS.MISC' WHEN 4 THEN 'DEVOLUC' WHEN 5 THEN 'N.CREDI'   
                       END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, PM10000.CURNCYID  
FROM         PM10000 WITH (NOLOCK) LEFT JOIN   
                      PM00200 WITH (NOLOCK) ON PM10000.VENDORID = PM00200.VENDORID LEFT JOIN TII_CHQ_SY40000 WITH (NOLOCK) ON PM00200.VNDCLSID = TII_CHQ_SY40000.VNDCLSID   
WHERE     (PM10000.DOCTYPE = 1 OR   
                      PM10000.DOCTYPE = 2 OR   
                      PM10000.DOCTYPE = 3 OR   
                      PM10000.DOCTYPE = 4 OR   
                      PM10000.DOCTYPE = 5)   
UNION   
SELECT     1 AS TYPE, 'OPEN' AS STATE, PM20000.DOCTYPE AS DOCTYPE, PM20000.DOCNUMBR AS DOCNUMBR, PM20000.VCHRNMBR AS VCHRNMBR,    
                      PM20000.DOCDATE AS DOCDATE,PM20000.PSTGDATE AS GLPOSTDT, PM20000.VENDORID AS CUSTVENDID,    
                      CASE PM20000.VOIDED WHEN 0 THEN CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN PM20000.TRXDSCRN ELSE PM00200.VENDNAME END WHEN 1 THEN 'ANULADO' END AS CUSTVENDNAME,    
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN LEFT(PM20000.PORDNMBR, 18) + '     ' + SUBSTRING(PM20000.PORDNMBR,19, 2) ELSE PM00200.TXRGNNUM END AS TXRGNNUM,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.PRCHAMNT WHEN 1 THEN 0 END AS SALESPURCHAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.TRDISAMT WHEN 1 THEN 0 END AS TRDISAMT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.FRTAMNT WHEN 1 THEN 0 END AS FRTAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.MSCCHAMT WHEN 1 THEN 0 END AS MISCAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.TAXAMNT WHEN 1 THEN 0 END AS TAXAMNT,    
                      CASE PM20000.VOIDED WHEN 0 THEN PM20000.DOCAMNT WHEN 1 THEN 0 END AS DOCAMNT, PM20000.VOIDED AS Voided, '' AS DOCID,    
                      CASE PM20000.DOCTYPE WHEN 1 THEN 'FACTURA' WHEN 2 THEN 'CS.FIN.' WHEN 3 THEN 'CS.MISC' WHEN 4 THEN 'DEVOLUC' WHEN 5 THEN 'N.CREDI'   
                       END AS DOCTYPEDESC, '01/01/1900' AS VOIDDATE, PM20000.CURNCYID   
FROM         PM20000 WITH (NOLOCK) LEFT JOIN   
                      PM00200 WITH (NOLOCK) ON PM20000.VENDORID = PM00200.VENDORID LEFT JOIN TII_CHQ_SY40000 WITH (NOLOCK) ON PM00200.VNDCLSID = TII_CHQ_SY40000.VNDCLSID   
WHERE     (PM20000.DOCTYPE = 1 OR   
                      PM20000.DOCTYPE = 2 OR   
                      PM20000.DOCTYPE = 3 OR   
                      PM20000.DOCTYPE = 4 OR   
                      PM20000.DOCTYPE = 5) AND PM20000.VOIDED = 0  
UNION   
SELECT     1 AS TYPE, 'HIST' AS STATE, PM30200.DOCTYPE AS DOCTYPE, PM30200.DOCNUMBR AS DOCNUMBR, PM30200.VCHRNMBR AS VCHRNMBR,    
                      PM30200.DOCDATE AS DOCDATE, PM30200.PSTGDATE AS GLPOSTDT,PM30200.VENDORID AS CUSTVENDID,    
                      CASE PM30200.VOIDED WHEN 0 THEN CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN PM30200.TRXDSCRN ELSE PM00200.VENDNAME END WHEN 1 THEN 'ANULADO' END AS CUSTVENDNAME,    
                      CASE PM00200.VNDCLSID WHEN ISNULL(TII_CHQ_SY40000.VNDCLSID,'*/') THEN LEFT(PM30200.PORDNMBR, 18) + '     ' + SUBSTRING(PM30200.PORDNMBR,19, 2) ELSE PM00200.TXRGNNUM END AS TXRGNNUM,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.PRCHAMNT WHEN 1 THEN 0 END AS SALESPURCHAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.TRDISAMT WHEN 1 THEN 0 END AS TRDISAMT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.FRTAMNT WHEN 1 THEN 0 END AS FRTAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.MSCCHAMT WHEN 1 THEN 0 END AS MISCAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.TAXAMNT WHEN 1 THEN 0 END AS TAXAMNT,    
                      CASE PM30200.VOIDED WHEN 0 THEN PM30200.DOCAMNT WHEN 1 THEN 0 END AS DOCAMNT, PM30200.VOIDED AS Voided, '' AS DOCID,    
                      CASE PM30200.DOCTYPE WHEN 1 THEN 'FACTURA' WHEN 2 THEN 'CS.FIN.' WHEN 3 THEN 'CS.MISC' WHEN 4 THEN 'DEVOLUC' WHEN 5 THEN 'N.CREDI'   
                       END AS DOCTYPEDESC, PM30200.VOIDPDATE AS VOIDDATE, PM30200.CURNCYID   
FROM         PM30200 WITH (NOLOCK) LEFT JOIN   
                      PM00200 WITH (NOLOCK) ON PM30200.VENDORID = PM00200.VENDORID LEFT JOIN TII_CHQ_SY40000 WITH (NOLOCK) ON PM00200.VNDCLSID = TII_CHQ_SY40000.VNDCLSID   
WHERE     (PM30200.DOCTYPE = 1 OR   
                      PM30200.DOCTYPE = 2 OR   
                      PM30200.DOCTYPE = 3 OR   
                      PM30200.DOCTYPE = 4 OR   
                      PM30200.DOCTYPE = 5) AND PM30200.VOIDED = 0  
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[AWLI_DOCUMENTOS_SM]  TO [DYNGRP] 
GO
/*End_AWLI_DOCUMENTOS_SM*/
/*Begin_AWLI_IMPUESTOS*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[AWLI_IMPUESTOS]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[AWLI_IMPUESTOS]
GO

CREATE VIEW dbo.AWLI_IMPUESTOS 
AS 
SELECT     2 AS TYPE, dbo.RM10601.RMDTYPAL AS DOCTYPE, dbo.RM10601.DOCNUMBR AS VCHRNMBR, dbo.RM10601.TAXDTLID AS TAXDTLID,    
                      dbo.RM10601.TAXAMNT AS TAXAMNT, dbo.RM10601.TAXDTSLS AS TAXDTAMT, dbo.RM10601.TDTTXSLS AS TDTTXAMT   
FROM         dbo.RM10601 WITH (NOLOCK) LEFT OUTER JOIN   
                      dbo.RM20101 WITH (NOLOCK) ON dbo.RM10601.CUSTNMBR = dbo.RM20101.CUSTNMBR AND dbo.RM10601.DOCNUMBR = dbo.RM20101.DOCNUMBR AND    
                      dbo.RM10601.RMDTYPAL = dbo.RM20101.RMDTYPAL   
WHERE     (ISNULL(dbo.RM20101.VOIDSTTS, 0) = 0) AND (dbo.RM10601.RMDTYPAL = 1 OR   
                      dbo.RM10601.RMDTYPAL = 3 OR   
                      dbo.RM10601.RMDTYPAL = 4 OR   
                      dbo.RM10601.RMDTYPAL = 5 OR   
                      dbo.RM10601.RMDTYPAL = 6 OR   
                      dbo.RM10601.RMDTYPAL = 7 OR   
                      dbo.RM10601.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, RM30601.RMDTYPAL AS DOCTYPE, RM30601.DOCNUMBR AS VCHRNMBR, RM30601.TAXDTLID AS TAXDTLID,    
                      RM30601.TAXAMNT AS TAXAMNT, RM30601.TAXDTSLS AS TAXDTAMT, RM30601.TDTTXSLS AS TDTTXAMT   
FROM         RM30601 WITH (NOLOCK) LEFT OUTER JOIN   
                      RM30101 WITH (NOLOCK) ON RM30601.CUSTNMBR = RM30101.CUSTNMBR AND RM30601.DOCNUMBR = RM30101.DOCNUMBR AND    
                      RM30601.RMDTYPAL = RM30101.RMDTYPAL   
WHERE     (ISNULL(RM30101.VOIDSTTS, 0) = 0) AND (RM30601.RMDTYPAL = 1 OR   
                      RM30601.RMDTYPAL = 3 OR   
                      RM30601.RMDTYPAL = 4 OR   
                      RM30601.RMDTYPAL = 5 OR   
                      RM30601.RMDTYPAL = 6 OR   
                      RM30601.RMDTYPAL = 7 OR   
                      RM30601.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, (CASE SOP10105.SOPTYPE WHEN 3 THEN 1 WHEN 4 THEN 8 END) AS DOCTYPE, SOP10105.SOPNUMBE AS VCHRNMBR,    
                      SOP10105.TAXDTLID AS TAXDTLID, SOP10105.TXDTOTTX AS TAXAMNT, SOP10105.TAXDTSLS AS TAXDTAMT,    
                      SOP10105.TDTTXSLS AS TDTTXAMT   
FROM         SOP10105 WITH (NOLOCK) INNER JOIN   
                      SOP10100 WITH (NOLOCK) ON SOP10105.SOPNUMBE = SOP10100.SOPNUMBE AND SOP10105.SOPTYPE = SOP10100.SOPTYPE   
WHERE     (SOP10105.SOPTYPE = 3 OR   
                      SOP10105.SOPTYPE = 4) AND SOP10105.LNITMSEQ = 0   
UNION   
SELECT     1 AS TYPE, PM10500.DOCTYPE AS DOCTYPE, PM10500.VCHRNMBR AS VCHRNMBR, PM10500.TAXDTLID AS TAXDTLID,    
                      PM10500.TAXAMNT AS TAXAMNT, PM10500.TXDTTPUR AS TAXDTAMT, PM10500.TDTTXPUR AS TDTTXAMT   
FROM         PM10500 WITH (NOLOCK) LEFT OUTER JOIN   
                      PM20000 WITH (NOLOCK) ON PM10500.VENDORID = PM20000.VENDORID AND PM10500.VCHRNMBR = PM20000.VCHRNMBR AND    
                      PM10500.DOCTYPE = PM20000.DOCTYPE   
WHERE     (ISNULL(PM20000.VOIDED, 0) = 0) AND (PM10500.DOCTYPE = 1 OR   
                      PM10500.DOCTYPE = 2 OR   
                      PM10500.DOCTYPE = 3 OR   
                      PM10500.DOCTYPE = 4 OR   
                      PM10500.DOCTYPE = 5)   
UNION   
SELECT     1 AS TYPE, PM30700.DOCTYPE AS DOCTYPE, PM30700.VCHRNMBR AS VCHRNMBR, PM30700.TAXDTLID AS TAXDTLID,    
                      PM30700.TAXAMNT AS TAXAMNT, PM30700.TXDTTPUR AS TAXDTAMT, PM30700.TDTTXPUR AS TDTTXAMT   
FROM         PM30700 WITH (NOLOCK) LEFT OUTER JOIN   
                      PM30200 WITH (NOLOCK) ON PM30700.VENDORID = PM30200.VENDORID AND PM30700.VCHRNMBR = PM30200.VCHRNMBR AND    
                      PM30700.DOCTYPE = PM30200.DOCTYPE   
WHERE     (ISNULL(PM30200.VOIDED, 0) = 0) AND (PM30700.DOCTYPE = 1 OR   
                      PM30700.DOCTYPE = 2 OR   
                      PM30700.DOCTYPE = 3 OR   
                      PM30700.DOCTYPE = 4 OR   
                      PM30700.DOCTYPE = 5)   
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[AWLI_IMPUESTOS]  TO [DYNGRP] 
GO 

/*End_AWLI_IMPUESTOS*/
/*Begin_AWLI_IMPUESTOS_SM*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[AWLI_IMPUESTOS_SM]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[AWLI_IMPUESTOS_SM]
GO

CREATE VIEW dbo.AWLI_IMPUESTOS_SM 
AS 
SELECT     2 AS TYPE, dbo.RM10601.RMDTYPAL AS DOCTYPE, dbo.RM10601.DOCNUMBR AS VCHRNMBR, dbo.RM10601.TAXDTLID AS TAXDTLID,    
                      dbo.RM10601.TAXAMNT AS TAXAMNT, dbo.RM10601.TAXDTSLS AS TAXDTAMT, dbo.RM10601.TDTTXSLS AS TDTTXAMT   
FROM         dbo.RM10601 WITH (NOLOCK) LEFT OUTER JOIN   
                      dbo.RM20101 WITH (NOLOCK) ON dbo.RM10601.CUSTNMBR = dbo.RM20101.CUSTNMBR AND dbo.RM10601.DOCNUMBR = dbo.RM20101.DOCNUMBR AND    
                      dbo.RM10601.RMDTYPAL = dbo.RM20101.RMDTYPAL   
WHERE     (ISNULL(dbo.RM20101.VOIDSTTS, 0) >= 0) AND (dbo.RM10601.RMDTYPAL = 1 OR   
                      dbo.RM10601.RMDTYPAL = 3 OR   
                      dbo.RM10601.RMDTYPAL = 4 OR   
                      dbo.RM10601.RMDTYPAL = 5 OR   
                      dbo.RM10601.RMDTYPAL = 6 OR   
                      dbo.RM10601.RMDTYPAL = 7 OR   
                      dbo.RM10601.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, RM30601.RMDTYPAL AS DOCTYPE, RM30601.DOCNUMBR AS VCHRNMBR, RM30601.TAXDTLID AS TAXDTLID,    
                      RM30601.TAXAMNT AS TAXAMNT, RM30601.TAXDTSLS AS TAXDTAMT, RM30601.TDTTXSLS AS TDTTXAMT   
FROM         RM30601 WITH (NOLOCK) LEFT OUTER JOIN   
                      RM30101 WITH (NOLOCK) ON RM30601.CUSTNMBR = RM30101.CUSTNMBR AND RM30601.DOCNUMBR = RM30101.DOCNUMBR AND    
                      RM30601.RMDTYPAL = RM30101.RMDTYPAL   
WHERE     (ISNULL(RM30101.VOIDSTTS, 0) >= 0) AND (RM30601.RMDTYPAL = 1 OR   
                      RM30601.RMDTYPAL = 3 OR   
                      RM30601.RMDTYPAL = 4 OR   
                      RM30601.RMDTYPAL = 5 OR   
                      RM30601.RMDTYPAL = 6 OR   
                      RM30601.RMDTYPAL = 7 OR   
                      RM30601.RMDTYPAL = 8)   
UNION   
SELECT     2 AS TYPE, (CASE SOP10105.SOPTYPE WHEN 3 THEN 1 WHEN 4 THEN 8 END) AS DOCTYPE, SOP10105.SOPNUMBE AS VCHRNMBR,    
                      SOP10105.TAXDTLID AS TAXDTLID, SOP10105.TXDTOTTX AS TAXAMNT, SOP10105.TAXDTSLS AS TAXDTAMT,    
                      SOP10105.TDTTXSLS AS TDTTXAMT   
FROM         SOP10105 WITH (NOLOCK) INNER JOIN   
                      SOP10100 WITH (NOLOCK) ON SOP10105.SOPNUMBE = SOP10100.SOPNUMBE AND SOP10105.SOPTYPE = SOP10100.SOPTYPE   
WHERE     (SOP10105.SOPTYPE = 3 OR   
                      SOP10105.SOPTYPE = 4) AND SOP10105.LNITMSEQ = 0   
UNION   
SELECT     2 AS TYPE, (CASE SOP10105.SOPTYPE WHEN 3 THEN 1 WHEN 4 THEN 8 END) AS DOCTYPE, SOP10105.SOPNUMBE AS VCHRNMBR,    
                      SOP10105.TAXDTLID AS TAXDTLID, SOP10105.TXDTOTTX AS TAXAMNT, SOP10105.TAXDTSLS AS TAXDTAMT,    
                      SOP10105.TDTTXSLS AS TDTTXAMT   
FROM         SOP10105 WITH (NOLOCK) INNER JOIN   
                      SOP30200 WITH (NOLOCK) ON SOP10105.SOPNUMBE = SOP30200.SOPNUMBE AND SOP10105.SOPTYPE = SOP30200.SOPTYPE   
WHERE     (SOP10105.SOPTYPE = 3 OR   
                      SOP10105.SOPTYPE = 4) AND SOP10105.LNITMSEQ = 0 AND SOP30200.VOIDSTTS = 1  
UNION   
SELECT     1 AS TYPE, PM10500.DOCTYPE AS DOCTYPE, PM10500.VCHRNMBR AS VCHRNMBR, PM10500.TAXDTLID AS TAXDTLID,    
                      PM10500.TAXAMNT AS TAXAMNT, PM10500.TXDTTPUR AS TAXDTAMT, PM10500.TDTTXPUR AS TDTTXAMT   
FROM         PM10500 WITH (NOLOCK) LEFT OUTER JOIN   
                      PM20000 WITH (NOLOCK) ON PM10500.VENDORID = PM20000.VENDORID AND PM10500.VCHRNMBR = PM20000.VCHRNMBR AND    
                      PM10500.DOCTYPE = PM20000.DOCTYPE   
WHERE     (ISNULL(PM20000.VOIDED, 0) = 0) AND (PM10500.DOCTYPE = 1 OR   
                      PM10500.DOCTYPE = 2 OR   
                      PM10500.DOCTYPE = 3 OR   
                      PM10500.DOCTYPE = 4 OR   
                      PM10500.DOCTYPE = 5)   
UNION   
SELECT     1 AS TYPE, PM30700.DOCTYPE AS DOCTYPE, PM30700.VCHRNMBR AS VCHRNMBR, PM30700.TAXDTLID AS TAXDTLID,    
                      PM30700.TAXAMNT AS TAXAMNT, PM30700.TXDTTPUR AS TAXDTAMT, PM30700.TDTTXPUR AS TDTTXAMT   
FROM         PM30700 WITH (NOLOCK) LEFT OUTER JOIN   
                      PM30200 WITH (NOLOCK) ON PM30700.VENDORID = PM30200.VENDORID AND PM30700.VCHRNMBR = PM30200.VCHRNMBR AND    
                      PM30700.DOCTYPE = PM30200.DOCTYPE   
WHERE     (ISNULL(PM30200.VOIDED, 0) = 0) AND (PM30700.DOCTYPE = 1 OR   
                      PM30700.DOCTYPE = 2 OR   
                      PM30700.DOCTYPE = 3 OR   
                      PM30700.DOCTYPE = 4 OR   
                      PM30700.DOCTYPE = 5)   
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[AWLI_IMPUESTOS_SM]  TO [DYNGRP] 
GO 

/*End_AWLI_IMPUESTOS_SM*/
/*Begin_TII_GL_TRX_YEC*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[TII_GL_TRX_YEC]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[TII_GL_TRX_YEC]
GO

CREATE VIEW dbo.TII_GL_TRX_YEC AS
SELECT     TOP 100 PERCENT RTRIM(B.ACTNUMST) AS ACTNUMST, A.*, C.ACTALIAS AS ACTALIAS, C.ACCTTYPE AS ACCTTYPE, C.ACTDESCR AS ACTDESCR, 
           C.PSTNGTYP AS PSTNGTYP, ISNULL(D.ACCATDSC, '') AS ACCATDSC, dbo.MC40000.FUNLCURR AS FUNLCURR, E.CRNCYSYM AS CRNCYSYM, 
           E.DECPLCUR AS DECPLCUR, E.DECSYMBL AS DECSYMBL, E.THOUSSYM AS THOUSSYM, F.CMPNYNAM AS CMPNYNAM, 
           G.DECSYMBL AS DECFUNL, G.THOUSSYM AS THOUSFUNL, G.CRNCYSYM AS FUNLSYM 
FROM         (SELECT     OPENYEAR, JRNENTRY, RCTRXSEQ, SOURCDOC, REFRENCE, DSCRIPTN, TRXDATE, TRXSORCE, ACTINDX, POLLDTRX, LASTUSER, 
                                  LSTDTEDT, USWHPSTD, ORGNTSRC, ORGNATYP, QKOFSET, SERIES, ORTRXTYP, ORCTRNUM, ORMSTRID, ORMSTRNM, ORDOCNUM, 
                                  ORPSTDDT, ORTRXSRC, OrigDTASeries, OrigSeqNum, SEQNUMBR, DTA_GL_Status, DTA_Index, CURNCYID, CURRNIDX, RATETPID, 
                                  EXGTBLID, XCHGRATE, EXCHDATE, TIME1, RTCLCMTD, NOTEINDX, ICTRX, ORCOMID, ORIGINJE, PERIODID, CRDTAMNT, DEBITAMT, 
                                  ORCRDAMT, ORDBTAMT, DOCDATE, PSTGNMBR, PPSGNMBR, DENXRATE, MCTRXSTT, CorrespondingUnit, DEX_ROW_ID 
            FROM          GL20000 
            UNION 
            SELECT     HSTYEAR, JRNENTRY, RCTRXSEQ, SOURCDOC, REFRENCE, DSCRIPTN, TRXDATE, TRXSORCE, ACTINDX, POLLDTRX, LASTUSER, 
                                  LSTDTEDT, USWHPSTD, ORGNTSRC, ORGNATYP, QKOFSET, SERIES, ORTRXTYP, ORCTRNUM, ORMSTRID, ORMSTRNM, ORDOCNUM, 
                                  ORPSTDDT, ORTRXSRC, OrigDTASeries, OrigSeqNum, SEQNUMBR, DTA_GL_Status, DTA_Index, CURNCYID, CURRNIDX, RATETPID, 
                                  EXGTBLID, XCHGRATE, EXCHDATE, TIME1, RTCLCMTD, NOTEINDX, ICTRX, ORCOMID, ORIGINJE, PERIODID, CRDTAMNT, DEBITAMT, 
                                  ORCRDAMT, ORDBTAMT, DOCDATE, PSTGNMBR, PPSGNMBR, DENXRATE, MCTRXSTT, CorrespondingUnit, DEX_ROW_ID 
            FROM         GL30000) A INNER JOIN 
           dbo.GL00105 B ON A.ACTINDX = B.ACTINDX INNER JOIN 
           dbo.GL00100 C ON A.ACTINDX = C.ACTINDX LEFT OUTER JOIN 
           dbo.GL00102 D ON C.ACCATNUM = D.ACCATNUM CROSS JOIN 
           dbo.MC40000 LEFT OUTER JOIN 
           DYNAMICS.dbo.MC40200 E ON A.CURNCYID = E.CURNCYID CROSS JOIN 
           DYNAMICS.dbo.SY01500 F INNER JOIN 
           DYNAMICS.dbo.MC40200 G ON dbo.MC40000.FUNLCURR = G.CURNCYID 
WHERE F.INTERID = DB_NAME() 
ORDER BY A.OPENYEAR, A.TRXDATE, A.JRNENTRY 
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[TII_GL_TRX_YEC]  TO [DYNGRP] 
GO 

/*End_TII_GL_TRX_YEC*/
/*Begin_TII_GL_Year_End_Entries*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[TII_GL_Year_End_Entries]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[TII_GL_Year_End_Entries]
GO

CREATE VIEW dbo.TII_GL_Year_End_Entries AS
SELECT A.ACTINDX, (A.DEBITAMT*(-1) + A.CRDTAMNT) AS TRXAMNT, A.TRXDATE, A.JRNENTRY, 
A.SOURCDOC, A.TRXSORCE, A.REFRENCE, A.CURNCYID, A.CURRNIDX, '3' ORIGEN, A.DEX_ROW_ID 
FROM TII_GL_TRX_YEC A 
INNER JOIN 
(select TRXDATE, JRNENTRY from TII_GL30100 
group by TRXDATE, JRNENTRY) CIERRE 
ON A.TRXDATE = CIERRE.TRXDATE AND A.JRNENTRY = CIERRE.JRNENTRY 
UNION 
SELECT A.ACTINDX, A.TRXAMNT, A.TRXDATE, A.JRNENTRY, A.SOURCDOC, A.TRXSORCE, A.REFRENCE, 
A.CURNCYID, A.CURRNIDX, '2' ORIGEN, A.DEX_ROW_ID FROM TII_GL30100 A 
INNER JOIN 
(select TRXDATE, JRNENTRY from TII_GL30100 
group by TRXDATE, JRNENTRY) CIERRE 
ON A.TRXDATE = CIERRE.TRXDATE AND A.JRNENTRY = CIERRE.JRNENTRY 
UNION 
SELECT A.ACTINDX, (A.DEBITAMT + A.CRDTAMNT*(-1)) AS TRXAMNT, DATEADD(day,1,A.TRXDATE) TRXDATE, A.JRNENTRY,  
A.SOURCDOC, A.TRXSORCE, A.REFRENCE, A.CURNCYID, A.CURRNIDX, '0' ORIGEN, A.DEX_ROW_ID 
FROM TII_GL_TRX_YEC A 
INNER JOIN  
(select TRXDATE, JRNENTRY from TII_GL30100 
group by TRXDATE, JRNENTRY) CIERRE 
ON A.TRXDATE = CIERRE.TRXDATE AND A.JRNENTRY = CIERRE.JRNENTRY 
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[TII_GL_Year_End_Entries]  TO [DYNGRP] 
GO 

/*End_TII_GL_Year_End_Entries*/

/*Begin_TII_GL_TRX*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[TII_GL_TRX]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[TII_GL_TRX]
GO

CREATE VIEW dbo.TII_GL_TRX AS
SELECT     TOP 100 PERCENT RTRIM(B.ACTNUMST) AS ACTNUMST, A.*, C.ACTALIAS AS ACTALIAS, C.ACCTTYPE AS ACCTTYPE, C.ACTDESCR AS ACTDESCR, 
           C.PSTNGTYP AS PSTNGTYP, ISNULL(D.ACCATDSC, '') AS ACCATDSC, dbo.MC40000.FUNLCURR AS FUNLCURR, E.CRNCYSYM AS CRNCYSYM, 
           E.DECPLCUR AS DECPLCUR, E.DECSYMBL AS DECSYMBL, E.THOUSSYM AS THOUSSYM, F.CMPNYNAM AS CMPNYNAM, 
           G.DECSYMBL AS DECFUNL, G.THOUSSYM AS THOUSFUNL, G.CRNCYSYM AS FUNLSYM 
FROM         (SELECT     OPENYEAR, JRNENTRY, RCTRXSEQ, SOURCDOC, REFRENCE, DSCRIPTN, TRXDATE, TRXSORCE, ACTINDX, POLLDTRX, LASTUSER, 
                                  LSTDTEDT, USWHPSTD, ORGNTSRC, ORGNATYP, QKOFSET, SERIES, ORTRXTYP, ORCTRNUM, ORMSTRID, ORMSTRNM, ORDOCNUM, 
                                  ORPSTDDT, ORTRXSRC, OrigDTASeries, OrigSeqNum, SEQNUMBR, DTA_GL_Status, DTA_Index, CURNCYID, CURRNIDX, RATETPID, 
                                  EXGTBLID, XCHGRATE, EXCHDATE, TIME1, RTCLCMTD, NOTEINDX, ICTRX, ORCOMID, ORIGINJE, PERIODID, CRDTAMNT, DEBITAMT, 
                                  ORCRDAMT, ORDBTAMT, DOCDATE, PSTGNMBR, PPSGNMBR, DENXRATE, MCTRXSTT, CorrespondingUnit, DEX_ROW_ID, '1' AS ORIGEN 
            FROM          GL20000 
            UNION 
            SELECT     HSTYEAR, JRNENTRY, RCTRXSEQ, SOURCDOC, REFRENCE, DSCRIPTN, TRXDATE, TRXSORCE, ACTINDX, POLLDTRX, LASTUSER, 
                                  LSTDTEDT, USWHPSTD, ORGNTSRC, ORGNATYP, QKOFSET, SERIES, ORTRXTYP, ORCTRNUM, ORMSTRID, ORMSTRNM, ORDOCNUM, 
                                  ORPSTDDT, ORTRXSRC, OrigDTASeries, OrigSeqNum, SEQNUMBR, DTA_GL_Status, DTA_Index, CURNCYID, CURRNIDX, RATETPID, 
                                  EXGTBLID, XCHGRATE, EXCHDATE, TIME1, RTCLCMTD, NOTEINDX, ICTRX, ORCOMID, ORIGINJE, PERIODID, CRDTAMNT, DEBITAMT, 
                                  ORCRDAMT, ORDBTAMT, DOCDATE, PSTGNMBR, PPSGNMBR, DENXRATE, MCTRXSTT, CorrespondingUnit, DEX_ROW_ID, 1 AS ORIGEN 
            FROM         GL30000 
            UNION 
           SELECT     YEAR(TRXDATE) AS HSTYEAR, JRNENTRY, A.DEX_ROW_ID AS RCTRXSEQ, SOURCDOC, REFRENCE, REFRENCE AS DSCRIPTN, 
                      TRXDATE, TRXSORCE, ACTINDX, 0 AS POLLDTRX, '' AS LASTUSER, TRXDATE AS LSTDTEDT, '' AS USWHPSTD, ORIGEN AS ORGNTSRC, 
                      1 AS ORGNATYP, 1 AS QKOFSET, 2 AS SERIES,0 AS ORTRXTYP, '' AS ORCTRNUM, '' AS ORMSTRID, '' AS ORMSTRNM, '' AS ORDOCNUM, 
                      0 AS ORPSTDDT, TRXSORCE AS ORTRXSRC, 0 AS OrigDTASeries, 0 AS OrigSeqNum, 0 AS SEQNUMBR, 0 AS DTA_GL_Status, 0 as DTA_Index, 
                      CURNCYID, CURRNIDX, '' AS RATETPID, '' AS EXGTBLID, 0 AS XCHGRATE, 0 AS EXCHDATE, 0 AS TIME1, 0 AS RTCLCMTD, 0 AS NOTEINDX, 0 AS ICTRX, 
                      '' AS ORCOMID, 0 AS ORIGINJE, 0 AS PERIOID, CASE SIGN(TRXAMNT) WHEN -1 THEN ABS(TRXAMNT) ELSE 0 END AS CRDTAMNT, 
                      CASE SIGN(TRXAMNT) WHEN 1 THEN TRXAMNT ELSE 0 END AS DEBITAMT, 0 AS ORCRDAMT, 0 AS ORDBTAMT, 0 AS DOCDATE,  
                      0 AS PSTGNMBR, 0 AS PPSGNMBR, 0 AS DENXRATE, 0 AS MCTRXSTT, '' AS CorrespondingUnit, A.DEX_ROW_ID, ORIGEN 
            FROM TII_GL_Year_End_Entries A INNER JOIN MC40000 B ON A.CURNCYID = B.FUNLCURR) A INNER JOIN 
           dbo.GL00105 B ON A.ACTINDX = B.ACTINDX INNER JOIN 
           dbo.GL00100 C ON A.ACTINDX = C.ACTINDX LEFT OUTER JOIN 
           dbo.GL00102 D ON C.ACCATNUM = D.ACCATNUM CROSS JOIN 
           dbo.MC40000 LEFT OUTER JOIN 
           DYNAMICS.dbo.MC40200 E ON A.CURNCYID = E.CURNCYID CROSS JOIN 
           DYNAMICS.dbo.SY01500 F INNER JOIN 
           DYNAMICS.dbo.MC40200 G ON dbo.MC40000.FUNLCURR = G.CURNCYID 
WHERE F.INTERID = DB_NAME() 
ORDER BY A.OPENYEAR, A.TRXDATE, A.ORIGEN, A.JRNENTRY 
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[TII_GL_TRX]  TO [DYNGRP] 
GO 

/*End_TII_GL_TRX*/
/*Begin_TII_IVA_RPT*/
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS OFF 
GO

if exists (select * from dbo.sysobjects where id = object_id(N'[dbo].[TII_IVA_RPT]') and OBJECTPROPERTY(id, N'IsView') = 1)
drop view [dbo].[TII_IVA_RPT]
GO

CREATE VIEW dbo.TII_IVA_RPT AS
SELECT     dbo.AWLI40001.RPTID, dbo.AWLI40001.DSCRIPTN, dbo.AWLI40001.TipoReporte, dbo.AWLI40001.STTDOCDT, dbo.AWLI40001.ENDDOCDT,  
           dbo.AWLI40001.STTPSTDT, dbo.AWLI40001.ENDPSTDT, dbo.AWLI40001.AWFiltraXDocumentDate, dbo.AWLI40001.AWFiltraXPostDate,  
           dbo.AWLI50001.USERID, dbo.AWLI50001.NOMCOL01, dbo.AWLI50001.NOMCOL02, dbo.AWLI50001.NOMCOL03, dbo.AWLI50001.NOMCOL04,  
           dbo.AWLI50001.NOMCOL05, dbo.AWLI50001.NOMCOL06, dbo.AWLI50001.NOMCOL07, dbo.AWLI50001.NOMCOL08, dbo.AWLI50001.NOMCOL09,  
           dbo.AWLI50001.NOMCOL10, dbo.AWLI50001.NOMCOL11, dbo.AWLI50001.NOMCOL12, dbo.AWLI50001.NOMCOL13, dbo.AWLI50001.NOMCOL14,  
           dbo.AWLI50001.NOMCOL15, dbo.AWLI50001.NOMCOL16, dbo.AWLI50001.NOMCOL17, dbo.AWLI50001.NOMCOL18, dbo.AWLI50001.NOMCOL19,  
           dbo.AWLI50001.NOMCOL20, dbo.AWLI50003.NumeroDeOrden, dbo.AWLI50003.IDGRIMP, dbo.AWLI50003.DSCRIPTN AS DSCRIPTN2,  
           dbo.AWLI50003.AWLI_DOCUMENT_STATE, dbo.AWLI50003.DOCTYPE, dbo.AWLI50003.DOCNUMBR, dbo.AWLI50003.VCHRNMBR,  
           dbo.AWLI50003.DOCDATE, dbo.AWLI50003.GLPOSTDT, dbo.AWLI50003.CUSTVNDR, dbo.AWLI50003.CUSTNAME, dbo.AWLI50003.TXRGNNUM,  
           dbo.AWLI50003.SLSAMNT, dbo.AWLI50003.TRDISAMT, dbo.AWLI50003.FRTAMNT, dbo.AWLI50003.MISCAMNT, dbo.AWLI50003.TAXAMNT,  
           dbo.AWLI50003.DOCAMNT, dbo.AWLI50003.Void, dbo.AWLI50003.DOCID, dbo.AWLI50003.AWLI_DOCTYPEDESC, dbo.AWLI50003.VOIDDATE,  
           dbo.AWLI50003.CURNCYID, dbo.AWLI50003.LETRA, dbo.AWLI50003.PDV, dbo.AWLI50003.FROM_NMBR, dbo.AWLI50003.TO_NMBR,  
           dbo.AWLI50003.RESP_TYPE, dbo.AWLI50003.CAI, dbo.AWLI50003.TO_DT, dbo.AWLI50003.COLIMP01, dbo.AWLI50003.COLIMP02,  
           dbo.AWLI50003.COLIMP03, dbo.AWLI50003.COLIMP04, dbo.AWLI50003.COLIMP05, dbo.AWLI50003.COLIMP06, dbo.AWLI50003.COLIMP07,  
           dbo.AWLI50003.COLIMP08, dbo.AWLI50003.COLIMP09, dbo.AWLI50003.COLIMP10, dbo.AWLI50003.COLIMP11, dbo.AWLI50003.COLIMP12,  
           dbo.AWLI50003.COLIMP13, dbo.AWLI50003.COLIMP14, dbo.AWLI50003.COLIMP15, dbo.AWLI50003.COLIMP16, dbo.AWLI50003.COLIMP17,  
           dbo.AWLI50003.COLIMP18, dbo.AWLI50003.COLIMP19, dbo.AWLI50003.COLIMP20, ISNULL(dbo.AWLI_PM00400.AWLI_DocNumber, '')  
           AS AWLI_DocNumber, dbo.MC40000.FUNLCURR, DYNAMICS.dbo.SY01500.CMPNYNAM, 
      G.DECSYMBL AS DECFUNL, G.THOUSSYM AS THOUSFUNL, G.CRNCYSYM AS FUNLSYM 
FROM         dbo.AWLI40001 INNER JOIN 
           dbo.AWLI50001 ON dbo.AWLI40001.RPTID = dbo.AWLI50001.RPTID INNER JOIN 
           dbo.AWLI50003 ON dbo.AWLI50001.USERID = dbo.AWLI50003.USERID AND dbo.AWLI50001.RPTID = dbo.AWLI50003.RPTID LEFT OUTER JOIN 
           dbo.AWLI_PM00400 ON dbo.AWLI50003.VCHRNMBR = dbo.AWLI_PM00400.VCHRNMBR AND  
           dbo.AWLI50003.CUSTVNDR = dbo.AWLI_PM00400.VENDORID AND dbo.AWLI50003.DOCTYPE = dbo.AWLI_PM00400.DOCTYPE CROSS JOIN 
           dbo.MC40000 CROSS JOIN DYNAMICS.dbo.SY01500 INNER JOIN 
           DYNAMICS.dbo.MC40200 G ON dbo.MC40000.FUNLCURR = G.CURNCYID 
WHERE DYNAMICS.dbo.SY01500.INTERID = DB_NAME() 
GO
SET QUOTED_IDENTIFIER OFF 
GO
SET ANSI_NULLS ON 
GO

GRANT  SELECT ,  INSERT ,  DELETE ,  UPDATE  ON [dbo].[TII_IVA_RPT]  TO [DYNGRP] 
GO 

/*End_TII_IVA_RPT*/
